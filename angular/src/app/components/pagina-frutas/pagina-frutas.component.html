<h1>Servicio Rest para Frutas</h1>

<!-- TODO crear un componente para reutilizar -->
<div *ngIf="mensaje != ''" class="alert alert-warning alert-dismissible fade show" role="alert">
    <p>{{mensaje}}</p>
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
</div>

<!--  Para Formularios muy simples usar BanaInaBox
<input type="text"  [(ngModel)]="frutaNueva.nombre" 
       class="form-control" 
       placeholder="Nombre Fruta minimo 3 letras">
<button (click)="nueva()" 
        class="btn btn-primary" 
        disabled="{{(frutaNueva.nombre.length<3)?'disabled':''}}">Crear Nueva</button>
-->
<div style="border:1px solid red; padding:10px;">
  <p>Valores: {{ formulario.value | json }}</p>
  <p>Estado:  {{ formulario.status | json }}</p> 
</div>

<form [formGroup]="formulario" (submit)="nueva()"  >
    <div class="form-group">
      <label for="nombre">Nombre</label>
      <input type="text" formControlName="nombre" class="form-control" placeholder="MÃ­nimo 3 letras">      
      <p *ngIf="formulario.controls.nombre.invalid && formulario.controls.nombre.touched"  
      class="text-danger">*recuerda que minimo 3 letras</p>
    </div>   
    <div class="form-group">
        <label for="nombre">Precio</label>
        <input type="number" formControlName="precio" class="form-control">      
      </div>   
      <button type="submit"
              class="btn btn-block btn-primary"
              [disabled]="formulario.invalid">Crear</button>
</form>


<table class="table table-bordered">
    <thead class="bg-light">
      <tr>
        <th scope="col">#</th>
        <th scope="col">Foto</th>
        <th scope="col">Nombre</th>
        <th scope="col">Precio</th>
        <th scope="col">Oferta</th>
        <th scope="col">Descuento</th>
        <th scope="col">Operaciones</th>
    </tr>
    </thead>
    <tbody>
      <tr *ngIf="frutas.length==0">
        <td colspan="3">Cargando datos...</td>
      </tr>  
      <tr *ngFor="let f of frutas">
        <th scope="row">{{f.id}}</th>
        <td><img src="{{f.imagen}}" alt="imagen de la fruta {{f.nombre}}"></td>
        <td>{{f.nombre}}</td>        
        <td>{{f.precio}}</td>    
        <td>{{f.oferta}}</td>   
        <td>{{f.descuento}}</td>    
        <td>
            <i class="fas fa-edit mr-4" (click)="editar(f)"></i>
            <i class="fas fa-trash-alt" (click)="eliminar(f)"></i>            
        </td>
      </tr>      
    </tbody>
  </table>